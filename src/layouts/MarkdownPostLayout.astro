---
import BaseLayout from "./BaseLayout.astro";
const { frontmatter } = Astro.props;
import "prismjs/themes/prism-tomorrow.css";
---

<BaseLayout pageTitle={frontmatter.title}>
  <p>Publicado en {frontmatter.pubDate.toString().slice(0, 10)}</p>
  <p>Escrito por {frontmatter.author}</p>
  <p>{frontmatter.description}</p>
  <img src={frontmatter.image.url} width="300" alt={frontmatter.image.alt} />

  <div class="tags">
    {
      frontmatter.tags.map((tag: string) => (
        <p class="tag">
          <a href={`/tags/${tag}`}>{tag}</a>
        </p>
      ))
    }
  </div>
  <slot />
</BaseLayout>

<style>
  /* Estilos generales */
  a {
    color: #00539f;
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
  }

  .tag {
    margin: 0.25em;
    border: dotted 1px #a1a1a1;
    border-radius: 0.5em;
    padding: 0.5em 1em;
    font-size: 1.15em;
    background-color: #f8fcfd;
  }

  /* ðŸŒŸ Bloques de cÃ³digo mejorados */
  pre {
    position: relative;
  }
  button.copy-button {
    position: absolute;
    inset: 5px 5px auto auto;
    width: 1em;
    height: 1em;
    border: 1px solid;
    box-shadow: -3px 3px #999;
  }

  button.pre code {
    background: none !important; /* Evita fondos duplicados */
    padding: 0;
  }

  /* ðŸ’» Agregar el prefijo "$" solo en bloques de Bash/Terminal */
  pre.language-bash::before,
  pre.language-shell::before {
    content: "$ ";
    color: #8be9fd;
    font-weight: bold;
  }
</style>

<!-- ðŸ“‹ Script para botÃ³n de copiar cÃ³digo -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("pre").forEach((block) => {
      const codeBlock = block.querySelector("code");
      if (!codeBlock) return; // Asegura que <code> existe dentro de <pre>

      // Crear el botÃ³n
      const btn = document.createElement("button");
      btn.className = "copy-button";
      btn.innerHTML = "ðŸ“‹";

      // Evento de copiar
      btn.onclick = () => {
        const text = codeBlock.innerText.trim(); // Copia solo el texto del cÃ³digo
        navigator.clipboard.writeText(text);
        btn.innerText = "âœ… Copiado!";
        setTimeout(() => (btn.innerHTML = "ðŸ“‹"), 2000);
      };

      // Asegurar que <pre> tenga posiciÃ³n relativa
      block.style.position = "relative";

      // ðŸ“Œ Insertar el botÃ³n ANTES del <code> dentro de <pre>
      block.insertBefore(btn, codeBlock);
    });
  });
</script>
